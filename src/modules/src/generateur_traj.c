

#include <math.h>

#include "param.h"
#include "log.h"
#include "math3d.h"
#include "usec_time.h"
#include "generateur_traj.h"
/*
 static double COEEF[8][36]={{ 0.0000000472804563, -0.0000000865462947,   0, 0.0000000983719354,                  0,   0, 0.0000000590207108,  0.000000079007964,   0, -0.0000000345938832, 0.0000000923524008,   0, -0.0000000964030205, 0.0000000207884662,   0, -0.0000000695796653, -0.0000000698882884,   0, 0.0000000212149132, -0.0000000963100729,   0, 0.0000000925045984, -0.0000000341848205,   0, 0.0000000787459824, 0.0000000593697982,   0,                 0, 0.0000000983400982,   0, -0.0000000867546962, 0.0000000468969655,   0, -0.0000000863361981,  -0.000000047663021,   0},
		{  -0.00000109842214, -0.0000000381921225,   0, -0.000000561342453, -0.000000944925654,   0,  0.000000491832898, -0.000000982898896,   0,    0.00000109281935, -0.000000117199427,   0,   0.000000689072733,  0.000000856252655,   0,  -0.000000348204179,       0.00000104247,   0,  -0.00000106534377,   0.000000270245229,   0, -0.000000803011217,  -0.000000750441754,   0,   0.00000019760615,  -0.00000108117605,   0,  0.00000101654533, -0.000000417882071,   0,   0.000000900877426,  0.000000629610757,   0, -0.0000000430530331,    0.00000109824236,   0},
		{  0.000000107439659,     0.0000100475349,   0,  -0.00000839665916,   0.00000551911361,   0,  -0.00000918090827,  -0.00000408355524,   0,   -0.00000152427266,  -0.00000993182223,   0,     0.0000075337722,  -0.00000664881767,   0,    0.00000966530164,     0.0000027470792,   0,   0.00000291059733,    0.00000961732412,   0,  -0.00000652009675,     0.0000076454456,   0,  -0.00000995624394,  -0.00000135562035,   0, -0.00000423866637,   -0.0000091103352,   0,    0.00000537592152,  -0.00000848904988,   0,      0.000010047912, -0.0000000629712521,   0},
		{    0.0000999469169, -0.0000000252738898,   0,    0.0000540228169,     0.000084088775,   0,   -0.0000415696118,     0.000090891992,   0,    -0.0000989431311,    0.0000141295307,   0,     -0.000065348792,    -0.000075623556,   0,     0.0000283269251,     -0.000095848694,   0,    0.0000959589979,    -0.0000279509848,   0,    0.0000753668106,     0.0000656447309,   0,   -0.0000145172749,    0.0000988869838,   0,  -0.0000910542447,    0.0000412129998,   0,    -0.0000838763619,   -0.0000543520261,   0,   0.000000417061227,    -0.0000999460499,   0},
		{                  0,              -0.001,   0,     0.000841470985,    -0.000540302306,   0,     0.000909297427,     0.000416146837,   0,      0.000141120008,     0.000989992497,   0,     -0.000756802495,     0.000653643621,   0,     -0.000958924275,     -0.000283662185,   0,    -0.000279415498,     -0.000960170287,   0,     0.000656986599,     -0.000753902254,   0,     0.000989358247,     0.000145500034,   0,    0.000412118485,     0.000911130262,   0,     -0.000544021111,     0.000839071529,   0,     -0.000999990207,   -0.00000442569799,   0},
		{              -0.01,                   0,   0,     -0.00540302306,     -0.00841470985,   0,      0.00416146837,     -0.00909297427,   0,       0.00989992497,     -0.00141120008,   0,       0.00653643621,      0.00756802495,   0,      -0.00283662185,       0.00958924275,   0,     -0.00960170287,       0.00279415498,   0,     -0.00753902254,      -0.00656986599,   0,      0.00145500034,     -0.00989358247,   0,     0.00911130262,     -0.00412118485,   0,       0.00839071529,      0.00544021111,   0,    -0.0000442569799,       0.00999990207,   0},
		{                  0,                 0.1,   0,      -0.0841470985,       0.0540302306,   0,      -0.0909297427,      -0.0416146837,   0,       -0.0141120008,      -0.0989992497,   0,        0.0756802495,      -0.0653643621,   0,        0.0958924275,        0.0283662185,   0,       0.0279415498,        0.0960170287,   0,      -0.0656986599,        0.0753902254,   0,      -0.0989358247,      -0.0145500034,   0,     -0.0412118485,      -0.0911130262,   0,        0.0544021111,      -0.0839071529,   0,        0.0999990207,      0.000442569799,   0},
		{                1.0,                   0, 1.0,        0.540302306,        0.841470985, 1.0,       -0.416146837,        0.909297427, 1.0,        -0.989992497,        0.141120008, 1.0,        -0.653643621,       -0.756802495, 1.0,         0.283662185,        -0.958924275, 1.0,        0.960170287,        -0.279415498, 1.0,        0.753902254,         0.656986599, 1.0,       -0.145500034,        0.989358247, 1.0,      -0.911130262,        0.412118485, 1.0,        -0.839071529,       -0.544021111, 1.0,       0.00442569799,        -0.999990207, 1.0}};

static double time[13]={0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0};
 */
/*
static double COEEF[8][129]={{  -4.6090535,  58.7654321,  -46.090535,  0.879003626, -0.0623344053,   0, -0.861410362,  0.185755592,   0,  0.826575965,  -0.30545888,   0, -0.775197643,  0.419048406,   0,  0.708303736, -0.524250675,   0, -0.627233124,  0.618960064,   0,  0.533608437, -0.701280962,   0, -0.429303574,  0.769565718,   0,  0.316406197,  -0.82244761,   0, -0.197175947,  0.858868208,   0, 0.0739992201, -0.878098552,   0,  0.0506586022,   0.879753749,   0, -0.174302492, -0.863800668,   0,  0.294457717,  0.830558611,   0, -0.408719368, -0.780692917,   0,   0.514800498,   0.71520165,   0, -0.610577893, -0.635395616,   0,  0.694134567,  0.542872135,   0, -0.763798133, -0.439483065,   0,  0.818174274,  0.327297738,   0, -0.856174652, -0.208561544,   0,  0.877038688, 0.0856509903,   0,  -0.880348789,  0.038973869,   0,  0.866038703, -0.162818666,   0, -0.834394846,  0.283404646,   0,  0.786050571, -0.398318281,   0, -0.721973488,   0.505259572,   0,  0.643446101,  -0.60208809,   0, -0.552040136,   0.68686581,   0,  0.449585084, -0.757895906,   0, -0.338131583,  0.813756711,   0,  0.219910376,  -0.85333017,   0, -0.097287662,  0.875824219,   0,  -0.0272822655,  -0.880788641,   0,  0.151306138,  0.868124072,   0, -0.272301618, -0.838083994,   0,  0.387846978,  0.791269659,   0, -0.495629579, -0.728618057,   0,   0.59349215,  0.651383159,   0, -0.679475972, -0.561110823,   0,  -30.3672635,   50.5217645,   46.090535, 0, 0, 0},
{  11.3580247, -87.4074074,  69.1358025,  -1.37856099,  -0.753366872,   0,   1.47108017,  0.551285013,   0,  -1.53415568, -0.338169181,   0,   1.56652505,  0.118284891,   0,  -1.56754041,  0.103966873,   0,   1.53718143, -0.324137739,   0,  -1.47605577,  0.537820986,   0,   1.38538683, -0.740739742,   0,  -1.26698937,  0.928832587,   0,   1.12323311,  -1.09833484,   0, -0.956995325,   1.24585392,   0,   0.771603276,   -1.36843722,   0, -0.570767583,   1.46363124,   0,  0.358507972,  -1.52953067,   0, -0.139072822,   1.56481653,   0, -0.0831458716,  -1.56878258,   0,    0.3037004,   1.54134944,   0, -0.518176363,  -1.48306618,   0,  0.722281022,   1.39509934,   0, -0.911929222,  -1.27920957,   0,   1.08332515,   1.13771642,   0,  -1.23303832, -0.973451863,   0,    1.35807222,  0.789703662,   0,   -1.4559243, -0.590149537,   0,   1.52463604,  0.378783565,   0,  -1.56283218, -0.159836238,   0,   1.56974822, -0.0623102133,   0,  -1.54524574,  0.283209525,   0,   1.48981516, -0.498440396,   0,  -1.40456592,  0.703694979,   0,   1.29120428, -0.894865103,   0,  -1.15199917,   1.06812449,   0,  0.989736801,  -1.22000537,   0,    -0.80766484,    1.34746783,   0,   0.60942746,  -1.44796071,   0, -0.398992387,   1.51947264,   0,  0.180571478,  -1.56057232,   0,  0.041463571,   1.57043714,   0, -0.262668726,  -1.54886964,   0,  0.478616564,   1.49630151,   0,   49.5995597,  -73.8052497, -69.1358025, 0, 0, 0},
{ -10.3703704,  51.1111111, -41.4814815, 0.0908254787,    1.27025009,   0, -0.269174245,  -1.24472077,   0,  0.442135488,   1.19427835,   0, -0.606247385,  -1.11993244,   0,  0.758225237,   1.02317108,   0, -0.895027206, -0.905930935,   0,    1.0139152,  0.770558582,   0,  -1.11250967, -0.619763493,   0,   1.18883726,  0.456563834,   0,  -1.24137026, -0.284226047,   0,   1.26905722,  0.106199473,   0,     -1.271344,   0.073952684,   0,   1.24818481, -0.252624677,   0,   -1.2000432,  0.426240386,   0,   1.12788272, -0.591324891,   0,   -1.03314766,  0.744574024,   0,  0.917734137, -0.882920502,   0, -0.783952161,   1.00359532,   0,  0.634479377,  -1.10418317,   0, -0.472307484,   1.18267079,   0,  0.300682354,  -1.23748724,   0, -0.123039064,   1.26753538,   0, -0.0570668529,  -1.27221379,   0,  0.236030577,   1.25142883,   0, -0.410270147,  -1.20559652,   0,  0.576298158,   1.13563418,   0, -0.730791557,   -1.04294212,   0,  0.870658158,   0.92937556,   0,  -0.99309853, -0.797207545,   0,   1.09566203,  0.649083415,   0,  -1.17629584, -0.487967876,   0,   1.23338609,  0.317085657,   0,   -1.2657901, -0.139856967,   0,     1.27285932, -0.0401709621,   0,  -1.25445225,  0.219394869,   0,   1.21093731, -0.394227586,   0,  -1.14318545,  0.561169835,   0,   1.05255273, -0.716880266,   0, -0.940853153,  0.858242334,   0,  0.810322397, -0.982426675,   0,  -33.3783179,   41.7026557,  41.4814815, 0, 0, 0},
{   3.7037037,       -12.0,  10.3703704,  0.989764183, -0.0418677887,   0, -0.973950732,  0.181124326,   0,  0.938643651, -0.316755659,   0,  -0.88454961,  0.446047125,   0,  0.812751303, -0.566410955,   0, -0.724685773,  0.675438066,   0,  0.622115652, -0.770946279,   0, -0.507093882,  0.851023998,   0,  0.381922625, -0.914068465,   0, -0.249107184,  0.958817846,   0,  0.111305861, -0.984376481,   0,  0.0287232496,   0.990232814,   0, -0.168177464,  -0.97626963,   0,  0.304265606,  0.942766403,   0, -0.434263869, -0.890393701,   0,   0.555570338,  0.820199762,   0, -0.665757063,  -0.73358952,   0,  0.762618656,  0.632296478,   0, -0.844216431, -0.518348018,   0,  0.908917209,  0.394024819,   0, -0.955426002,  -0.26181521,   0,  0.982811938,  0.124365368,   0,  -0.990526886, 0.0155736472,   0,  0.978416432, -0.155200956,   0, -0.946722966,  0.291721917,   0,  0.896080833, -0.422404061,   0, -0.827503637,   0.544631785,   0,  0.742363949, -0.655958701,   0, -0.642365842,  0.754156598,   0,  0.529510779, -0.837260047,   0, -0.406057553,  0.903605729,   0,  0.274477083, -0.951865737,   0, -0.137402952,  0.981074146,   0, -0.00242129946,  -0.990646348,   0,  0.142197089,  0.980390758,   0, -0.279126803,  -0.95051264,   0,  0.410469792,  0.901610005,   0, -0.533597225, -0.834661639,   0,  0.646044706,  0.751007515,   0, -0.745561598, -0.652321971,   0,   9.63777169,  -8.41170042, -10.3703704, 0, 0, 0},
{           0,           0,           0,            0,          -1.0,   0,  0.141120008,  0.989992497,   0, -0.279415498, -0.960170287,   0,  0.412118485,  0.911130262,   0, -0.536572918, -0.843853959,   0,   0.65028784,  0.759687913,   0, -0.750987247, -0.660316708,   0,  0.836655639,   0.54772926,   0, -0.905578362, -0.424179007,   0,  0.956375928,  0.292138809,   0, -0.988031624,  -0.15425145,   0,    0.99991186,  0.0132767472,   0, -0.991778853,   0.12796369,   0,  0.963795386, -0.266642932,   0, -0.916521548,  0.399985315,   0,   0.850903525, -0.525321989,   0, -0.768254661,  0.640144339,   0,  0.670229176, -0.742154197,   0, -0.558789049,  0.829309833,   0,  0.436164755, -0.899866827,   0, -0.304810621,   0.95241298,   0,    0.1673557, -0.985896582,   0,  -0.026551154,  0.999647456,   0, -0.114784814,  -0.99339038,   0,  0.253823363,  0.967250588,   0, -0.387781635,  -0.92175127,   0,  0.513978456,   0.857803093,   0, -0.629887994, -0.776685982,   0,   0.73319032,  0.680023496,   0, -0.821817837, -0.569750334,   0,  0.893996664,  0.448073616,   0, -0.948282141, -0.317428702,   0,  0.983587745,  0.180430449,   0,   -0.999206834, -0.0398208804,   0,  0.994826791, -0.101585704,   0, -0.970535284,  0.240959049,   0,  0.926818505, -0.375509598,   0, -0.864551449,  0.502544319,   0,  0.784980389, -0.619520613,   0, -0.689697941,  0.724097197,   0,  0.580611184, -0.814180971,           0, 0, 0, 0},
{           0,           0,           0,         -1.0,             0,   0,  0.989992497, -0.141120008,   0, -0.960170287,  0.279415498,   0,  0.911130262, -0.412118485,   0, -0.843853959,  0.536572918,   0,  0.759687913,  -0.65028784,   0, -0.660316708,  0.750987247,   0,   0.54772926, -0.836655639,   0, -0.424179007,  0.905578362,   0,  0.292138809, -0.956375928,   0,  -0.15425145,  0.988031624,   0,  0.0132767472,   -0.99991186,   0,   0.12796369,  0.991778853,   0, -0.266642932, -0.963795386,   0,  0.399985315,  0.916521548,   0,  -0.525321989, -0.850903525,   0,  0.640144339,  0.768254661,   0, -0.742154197, -0.670229176,   0,  0.829309833,  0.558789049,   0, -0.899866827, -0.436164755,   0,   0.95241298,  0.304810621,   0, -0.985896582,   -0.1673557,   0,   0.999647456,  0.026551154,   0,  -0.99339038,  0.114784814,   0,  0.967250588, -0.253823363,   0,  -0.92175127,  0.387781635,   0,  0.857803093,  -0.513978456,   0, -0.776685982,  0.629887994,   0,  0.680023496,  -0.73319032,   0, -0.569750334,  0.821817837,   0,  0.448073616, -0.893996664,   0, -0.317428702,  0.948282141,   0,  0.180430449, -0.983587745,   0,  -0.0398208804,   0.999206834,   0, -0.101585704, -0.994826791,   0,  0.240959049,  0.970535284,   0, -0.375509598, -0.926818505,   0,  0.502544319,  0.864551449,   0, -0.619520613, -0.784980389,   0,  0.724097197,  0.689697941,   0, -0.814180971, -0.580611184,           0, 0, 0, 0},
{           0,           0,           0,            0,           1.0,   0, -0.141120008, -0.989992497,   0,  0.279415498,  0.960170287,   0, -0.412118485, -0.911130262,   0,  0.536572918,  0.843853959,   0,  -0.65028784, -0.759687913,   0,  0.750987247,  0.660316708,   0, -0.836655639,  -0.54772926,   0,  0.905578362,  0.424179007,   0, -0.956375928, -0.292138809,   0,  0.988031624,   0.15425145,   0,   -0.99991186, -0.0132767472,   0,  0.991778853,  -0.12796369,   0, -0.963795386,  0.266642932,   0,  0.916521548, -0.399985315,   0,  -0.850903525,  0.525321989,   0,  0.768254661, -0.640144339,   0, -0.670229176,  0.742154197,   0,  0.558789049, -0.829309833,   0, -0.436164755,  0.899866827,   0,  0.304810621,  -0.95241298,   0,   -0.1673557,  0.985896582,   0,   0.026551154, -0.999647456,   0,  0.114784814,   0.99339038,   0, -0.253823363, -0.967250588,   0,  0.387781635,   0.92175127,   0, -0.513978456,  -0.857803093,   0,  0.629887994,  0.776685982,   0,  -0.73319032, -0.680023496,   0,  0.821817837,  0.569750334,   0, -0.893996664, -0.448073616,   0,  0.948282141,  0.317428702,   0, -0.983587745, -0.180430449,   0,    0.999206834,  0.0398208804,   0, -0.994826791,  0.101585704,   0,  0.970535284, -0.240959049,   0, -0.926818505,  0.375509598,   0,  0.864551449, -0.502544319,   0, -0.784980389,  0.619520613,   0,  0.689697941, -0.724097197,   0, -0.580611184,  0.814180971,           0, 0, 0, 0},
{           0,           0,           0,          1.0,             0, 1.0, -0.989992497,  0.141120008, 1.0,  0.960170287, -0.279415498, 1.0, -0.911130262,  0.412118485, 1.0,  0.843853959, -0.536572918, 1.0, -0.759687913,   0.65028784, 1.0,  0.660316708, -0.750987247, 1.0,  -0.54772926,  0.836655639, 1.0,  0.424179007, -0.905578362, 1.0, -0.292138809,  0.956375928, 1.0,   0.15425145, -0.988031624, 1.0, -0.0132767472,    0.99991186, 1.0,  -0.12796369, -0.991778853, 1.0,  0.266642932,  0.963795386, 1.0, -0.399985315, -0.916521548, 1.0,   0.525321989,  0.850903525, 1.0, -0.640144339, -0.768254661, 1.0,  0.742154197,  0.670229176, 1.0, -0.829309833, -0.558789049, 1.0,  0.899866827,  0.436164755, 1.0,  -0.95241298, -0.304810621, 1.0,  0.985896582,    0.1673557, 1.0,  -0.999647456, -0.026551154, 1.0,   0.99339038, -0.114784814, 1.0, -0.967250588,  0.253823363, 1.0,   0.92175127, -0.387781635, 1.0, -0.857803093,   0.513978456, 1.0,  0.776685982, -0.629887994, 1.0, -0.680023496,   0.73319032, 1.0,  0.569750334, -0.821817837, 1.0, -0.448073616,  0.893996664, 1.0,  0.317428702, -0.948282141, 1.0, -0.180430449,  0.983587745, 1.0,   0.0398208804,  -0.999206834, 1.0,  0.101585704,  0.994826791, 1.0, -0.240959049, -0.970535284, 1.0,  0.375509598,  0.926818505, 1.0, -0.502544319, -0.864551449, 1.0,  0.619520613,  0.784980389, 1.0, -0.724097197, -0.689697941, 1.0,  0.814180971,  0.580611184,         1.0, 0, 0, 0}};

static double time[44]={ 0, 3.0, 6.0, 9.0, 12.0, 15.0, 18.0, 21.0, 24.0, 27.0, 30.0, 33.0, 36.0, 39.0, 42.0, 45.0, 48.0, 51.0, 54.0, 57.0, 60.0, 63.0, 66.0, 69.0, 72.0, 75.0, 78.0, 81.0, 84.0, 87.0, 90.0, 93.0, 96.0, 99.0, 102.0, 105.0, 108.0, 111.0, 114.0, 117.0, 120.0, 123.0, 126.0, 129.0};
 */

static double COEEF[8][45]={{ -0.009072, 0.004956, -0.01008, 0.0000000472804563, -0.0000000865462947,   0, 0.0000000983719354,                  0,   0, 0.0000000590207108,  0.000000079007964,   0, -0.0000000345938832, 0.0000000923524008,   0, -0.0000000964030205, 0.0000000207884662,   0, -0.0000000695796653, -0.0000000698882884,   0, 0.0000000212149132, -0.0000000963100729,   0, 0.0000000925045984, -0.0000000341848205,   0, 0.0000000787459824, 0.0000000593697982,   0,                 0, 0.0000000983400982,   0, -0.0000000867546962, 0.0000000468969655,   0, -0.0000000863361981,  -0.000000047663021,   0,    0.0103146985, -0.000685649293, 0.01008, 0, 0, 0},
		{   0.04572, -0.02412,   0.0504,  -0.00000109842214, -0.0000000381921225,   0, -0.000000561342453, -0.000000944925654,   0,  0.000000491832898, -0.000000982898896,   0,    0.00000109281935, -0.000000117199427,   0,   0.000000689072733,  0.000000856252655,   0,  -0.000000348204179,       0.00000104247,   0,  -0.00000106534377,   0.000000270245229,   0, -0.000000803011217,  -0.000000750441754,   0,   0.00000019760615,  -0.00000108117605,   0,  0.00000101654533, -0.000000417882071,   0,   0.000000900877426,  0.000000629610757,   0, -0.0000000430530331,    0.00000109824236,   0,   -0.0516238432,    0.0026781366, -0.0504, 0, 0, 0},
		{   -0.0924,   0.0462,  -0.1008,  0.000000107439659,     0.0000100475349,   0,  -0.00000839665916,   0.00000551911361,   0,  -0.00000918090827,  -0.00000408355524,   0,   -0.00000152427266,  -0.00000993182223,   0,     0.0000075337722,  -0.00000664881767,   0,    0.00000966530164,     0.0000027470792,   0,   0.00000291059733,    0.00000961732412,   0,  -0.00000652009675,     0.0000076454456,   0,  -0.00000995624394,  -0.00000135562035,   0, -0.00000423866637,   -0.0000091103352,   0,    0.00000537592152,  -0.00000848904988,   0,      0.000010047912, -0.0000000629712521,   0,     0.103265282,   -0.0030921861,  0.1008, 0, 0, 0},
		{     0.078,  -0.0356,    0.084,    0.0000999469169, -0.0000000252738898,   0,    0.0000540228169,     0.000084088775,   0,   -0.0000415696118,     0.000090891992,   0,    -0.0000989431311,    0.0000141295307,   0,     -0.000065348792,    -0.000075623556,   0,     0.0000283269251,     -0.000095848694,   0,    0.0000959589979,    -0.0000279509848,   0,    0.0000753668106,     0.0000656447309,   0,   -0.0000145172749,    0.0000988869838,   0,  -0.0000910542447,    0.0000412129998,   0,    -0.0000838763619,   -0.0000543520261,   0,   0.000000417061227,    -0.0000999460499,   0,   -0.0856544684, -0.000521573589,  -0.084, 0, 0, 0},
		{         0,        0,        0,                  0,              -0.001,   0,     0.000841470985,    -0.000540302306,   0,     0.000909297427,     0.000416146837,   0,      0.000141120008,     0.000989992497,   0,     -0.000756802495,     0.000653643621,   0,     -0.000958924275,     -0.000283662185,   0,    -0.000279415498,     -0.000960170287,   0,     0.000656986599,     -0.000753902254,   0,     0.000989358247,     0.000145500034,   0,    0.000412118485,     0.000911130262,   0,     -0.000544021111,     0.000839071529,   0,     -0.000999990207,   -0.00000442569799,   0, -0.000536572918, -0.000843853959,       0, 0, 0, 0},
		{         0,        0,        0,              -0.01,                   0,   0,     -0.00540302306,     -0.00841470985,   0,      0.00416146837,     -0.00909297427,   0,       0.00989992497,     -0.00141120008,   0,       0.00653643621,      0.00756802495,   0,      -0.00283662185,       0.00958924275,   0,     -0.00960170287,       0.00279415498,   0,     -0.00753902254,      -0.00656986599,   0,      0.00145500034,     -0.00989358247,   0,     0.00911130262,     -0.00412118485,   0,       0.00839071529,      0.00544021111,   0,    -0.0000442569799,       0.00999990207,   0,  -0.00843853959,   0.00536572918,       0, 0, 0, 0},
		{         0,        0,        0,                  0,                 0.1,   0,      -0.0841470985,       0.0540302306,   0,      -0.0909297427,      -0.0416146837,   0,       -0.0141120008,      -0.0989992497,   0,        0.0756802495,      -0.0653643621,   0,        0.0958924275,        0.0283662185,   0,       0.0279415498,        0.0960170287,   0,      -0.0656986599,        0.0753902254,   0,      -0.0989358247,      -0.0145500034,   0,     -0.0412118485,      -0.0911130262,   0,        0.0544021111,      -0.0839071529,   0,        0.0999990207,      0.000442569799,   0,    0.0536572918,    0.0843853959,       0, 0, 0, 0},
		{         0,        0,        0,                1.0,                   0, 1.0,        0.540302306,        0.841470985, 1.0,       -0.416146837,        0.909297427, 1.0,        -0.989992497,        0.141120008, 1.0,        -0.653643621,       -0.756802495, 1.0,         0.283662185,        -0.958924275, 1.0,        0.960170287,        -0.279415498, 1.0,        0.753902254,         0.656986599, 1.0,       -0.145500034,        0.989358247, 1.0,      -0.911130262,        0.412118485, 1.0,        -0.839071529,       -0.544021111, 1.0,       0.00442569799,        -0.999990207, 1.0,     0.843853959,    -0.536572918,     1.0, 0, 0, 0}};

static double time[17]={ 0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0, 130.0, 140.0, 150.0,160.0};

static bool init;
static double offset;
void trajset(X_t *Reff,ctr_traj_t *time1){
	if(init==false){
		Reff->Morceau_traj=0;
		init=true;
		offset=time1->t1;
		for(int i=0;i<16;i++){
			time[i]=time[i]+15;
		}
	}

	double t1= usecTimestamp() / 1e6;
	int N=Reff->Morceau_traj;
	if( t1>=time[0] && N<=14){
		if(t1>=time[N+1]){

			N=N+1;

			Reff->Morceau_traj=N;

		}
		double t0=time[N] ;





		double c70=COEEF[0][N*3];
		double c60=COEEF[1][N*3];
		double c50=COEEF[2][N*3];
		double c40=COEEF[3][N*3];
		double c30=COEEF[4][N*3];
		double c20=COEEF[5][N*3];
		double c10=COEEF[6][N*3];
		double c00=COEEF[7][N*3];

		double c71=COEEF[0][N*3+1];
		double  c61=COEEF[1][N*3+1];
		double c51=COEEF[2][N*3+1];
		double c41=COEEF[3][N*3+1];
		double  c31=COEEF[4][N*3+1];
		double c21=COEEF[5][N*3+1];
		double c11=COEEF[6][N*3+1];
		double c01=COEEF[7][N*3+1];


		double  c72=COEEF[0][N*3+2];
		double  c62=COEEF[1][N*3+2];
		double   c52=COEEF[2][N*3+2];
		double c42=COEEF[3][N*3+2];
		double  c32=COEEF[4][N*3+2];
		double  c22=COEEF[5][N*3+2];
		double  c12=COEEF[6][N*3+2];
		double  c02=COEEF[7][N*3+2];

		double P[3]={c00 - c10*(t0 - t1) + (c20*pow((t0-t1),2))/2 - (c30*pow((t0-t1),3))/6 + (c40*pow((t0-t1),4))/24 - (c50*pow((t0-t1),5))/120 + (c60*pow((t0-t1),6))/720 - (c70*pow((t0-t1),7))/5040, c01 - c11*(t0 - t1) + (c21*pow((t0-t1),2))/2 - (c31*pow((t0-t1),3))/6 + (c41*pow((t0-t1),4))/24 - (c51*pow((t0-t1),5))/120 + (c61*pow((t0-t1),6))/720 - (c71*pow((t0-t1),7))/5040, c02 - c12*(t0 - t1) + (c22*pow((t0-t1),2))/2 - (c32*pow((t0-t1),3))/6 + (c42*pow((t0-t1),4))/24 - (c52*pow((t0-t1),5))/120 + (c62*pow((t0-t1),6))/720 - (c72*pow((t0-t1),7))/5040};
		double dP[3]={c10 - c20*(t0 - t1) + (c30*pow((t0-t1),2))/2 - (c40*pow((t0-t1),3))/6 + (c50*pow((t0-t1),4))/24 - (c60*pow((t0-t1),5))/120 + (c70*pow((t0-t1),6))/720,c11 - c21*(t0 - t1) + (c31*pow((t0-t1),2))/2 - (c41*pow((t0-t1),3))/6 + (c51*pow((t0-t1),4))/24 - (c61*pow((t0-t1),5))/120 + (c71*pow((t0-t1),6))/720,c12 - c22*(t0 - t1) + (c32*pow((t0-t1),2))/2 - (c42*pow((t0-t1),3))/6 + (c52*pow((t0-t1),4))/24 - (c62*pow((t0-t1),5))/120 + (c72*pow((t0-t1),6))/720};
		double d2P[3]={c20 - c30*(t0 - t1) + (c40*pow((t0-t1),2))/2 - (c50*pow((t0-t1),3))/6 + (c60*pow((t0-t1),4))/24 - (c70*pow((t0-t1),5))/120,c21 - c31*(t0 - t1) + (c41*pow((t0-t1),2))/2 - (c51*pow((t0-t1),3))/6 + (c61*pow((t0-t1),4))/24 - (c71*pow((t0-t1),5))/120,c22 - c32*(t0 - t1) + (c42*pow((t0-t1),2))/2 - (c52*pow((t0-t1),3))/6 + (c62*pow((t0-t1),4))/24 - (c72*pow((t0-t1),5))/120};
		double d3P[3]={c30 - c40*(t0 - t1) + (c50*pow((t0-t1),2))/2 - (c60*pow((t0-t1),3))/6 + (c70*pow((t0-t1),4))/24, c31 - c41*(t0 - t1) + (c51*pow((t0-t1),2))/2 - (c61*pow((t0-t1),3))/6 + (c71*pow((t0-t1),4))/24,c32 - c42*(t0 - t1) + (c52*pow((t0-t1),2))/2 - (c62*pow((t0-t1),3))/6 + (c72*pow((t0-t1),4))/24};
		double d4P[3]={c40 - c50*(t0 - t1) + (c60*pow((t0-t1),2))/2 - (c70*pow((t0-t1),3))/6,c41 - c51*(t0 - t1) + (c61*pow((t0-t1),2))/2 - (c71*pow((t0-t1),3))/6,c42 - c52*(t0 - t1) + (c62*pow((t0-t1),2))/2 - (c72*pow((t0-t1),3))/6};
		Reff->x1= P[0];
		Reff->x2= P[1];
		Reff->x3= P[2];

		Reff->x4= dP[0];
		Reff->x5= dP[1];
		Reff->x6= dP[2];

		Reff->x7= d2P[0];
		Reff->x8= d2P[1];
		Reff->x9= d2P[2];

		Reff->x10= d3P[0];
		Reff->x11= d3P[1];
		Reff->x12= d3P[2];

		Reff->d4x= d4P[0];
		Reff->d4y= d4P[1];
		Reff->d4z= d4P[2];

		Reff->x13= 0.0;
		Reff->psi=0.0;
		Reff->dpsi= 0.0;

		Reff->x14= 0.0;
		Reff->d2psi= 0.0;
		double dpsi= Reff->x14;
		double psi= Reff-> x13;

		double x7=  Reff->x7;
		double x8=  Reff->x8;
		double x9=  Reff->x9;
		double x10=  Reff->x10;
		double x11=  Reff->x11;
		double x12=  Reff->x12;
		double theta=atan2((100.0*(x7*cos(psi) + x8*sin(psi))),(100.0*x9 + 981.0));
		double dthetadpsi =((x8*cos(psi) - x7*sin(psi))*(10000.0*x9 + 98100.0))/(196200.0*x9 + 10000.0*x7*x7*cos(psi)*cos(psi) + 10000.0*x8*x8*sin(psi)*sin(psi) + 10000.0*x9*x9 + 20000.0*x7*x8*cos(psi)*sin(psi) + 962361.0);

		double phi=-1.0*atan2((7.07*fabs(100.0*x9 + 981.0)*(x8*cos(psi) - x7*sin(psi))),((100.0*x9 + 981.0)*sqrt(981.0*x9 + 50.0*x7*x7*cos(psi)*cos(psi) + 50.0*x8*x8*sin(psi)*sin(psi) + 50.0*x9*x9 + 100.0*x7*x8*cos(psi)*sin(psi) + 4810.0)));
		double dphidpsi =(0.01*sqrt((x7*cos(psi) + x8*sin(psi))*(x7*cos(psi) + x8*sin(psi)) + (x9 + 9.81)*(x9 + 9.81))*(x7*cos(psi) + x8*sin(psi))*(100.0*x9 + 100.0*x8*cos(psi) - 100.0*x7*sin(psi) + 981.0))/(fabs(x9 + 9.81)*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361));

		double dtheta=-sqrt(1/(196200.0*x9 + 5000.0*x7*x7*cos(2.0*psi) - 5000.0*x8*x8*cos(2.0*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2.0*psi) + 962361.0))*((0.01*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(1.49012e-8*x12 + 98100.0*x7*x10 + 98100.0*x8*x11 - 10000.0*x7*x7*x12 - 10000.0*x8*x8*x12 + 10000.0*x7*x9*x10 + 10000.0*x8*x9*x11))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) + (1.0*cos(psi + 1.5708)*(x9 + 9.81)*(9623.61*x11 - 981.0*x8*x12 + 1962.0*x9*x11 + 100.0*x7*x7*x11 + 100.0*x9*x9*x11 - 100.0*x7*x8*x10 - 100.0*x8*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) - (1.0*sin(psi + 1.5708)*(x9 + 9.81)*(9623.61*x10 - 981.0*x7*x12 + 1962.0*x9*x10 + 100.0*x8*x8*x10 + 100.0*x9*x9*x10 - 100.0*x7*x8*x11 - 100.0*x7*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) - (1.0*dpsi*(100.0*x9 + 981.0)*(100.0*x9 + 981.0)*(x8*cos(psi) - x7*sin(psi)))/(sqrt(1/(196200.0*x9 + 5000.0*x7*x7*cos(2.0*psi) - 5000.0*x8*x8*cos(2.0*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2.0*psi) + 962361.0))*(x9 + 9.81)*sqrt(10000.0*x7*x7 + 10000.0*x8*x8 + 10000.0*x9*x9 + 196200.0*x9 + 962361.0)*(196200.0*x9 + 5000.0*x7*x7*cos(2*psi) - 5000.0*x8*x8*cos(2*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2*psi) + 962361.0)))*sqrt(10000.0*x7*x7 + 10000.0*x8*x8 + 10000.0*x9*x9 + 196200.0*x9 + 962361.0);

		double dphi=(100*dpsi*fabs(100.0*x9 + 981.0)*(x7*cos(psi) + x8*sin(psi)))/((100.0*x9 + 981.0)*sqrt(196200.0*x9 + 5000.0*x7*x7*cos(2*psi) - 5000.0*x8*x8*cos(2*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2*psi) + 962361.0)) - (0.0001*(10000.0*sin(psi + 1.5708)*x7*x7 - 10000.0*x8*cos(psi + 1.5708)*x7 + 10000.0*sin(psi + 1.5708)*x9*x9 + 196200.0*sin(psi + 1.5708)*x9 + 962361.0*sin(psi + 1.5708))*(9623.61*x11 - 981.0*x8*x12 + 1962.0*x9*x11 + 100.0*x7*x7*x11 + 100.0*x9*x9*x11 - 100.0*x7*x8*x10 - 100.0*x8*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361)*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361)) - (0.0001*(100.0*x9 + 981.0)*(x7*cos(psi + 1.5708) + x8*sin(psi + 1.5708))*(1.49012e-8*x12 + 98100.0*x7*x10 + 98100.0*x8*x11 - 10000.0*x7*x7*x12 - 10000.0*x8*x8*x12 + 10000.0*x7*x9*x10 + 10000.0*x8*x9*x11))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361)*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361)) - (0.0001*(10000.0*cos(psi + 1.5708)*x8*x8 - 10000.0*x7*sin(psi + 1.5708)*x8 + 10000.0*cos(psi + 1.5708)*x9*x9 + 196200.0*cos(psi + 1.5708)*x9 + 962361.0*cos(psi + 1.5708))*(9623.61*x10 - 981.0*x7*x12 + 1962.0*x9*x10 + 100.0*x8*x8*x10 + 100.0*x9*x9*x10 - 100.0*x7*x8*x11 - 100.0*x7*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361)*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361));




		double w1=-(0.01*(962361.0*x10*cos(psi + 1.5708) + 962361.0*x11*sin(psi + 1.5708) + 10000.0*x8*x8*x10*cos(psi + 1.5708) + 10000.0*x9*x9*x10*cos(psi + 1.5708) + 10000.0*x7*x7*x11*sin(psi + 1.5708) + 10000.0*x9*x9*x11*sin(psi + 1.5708) - 98100.0*x7*x12*cos(psi + 1.5708) + 196200.0*x9*x10*cos(psi + 1.5708) - 98100.0*x8*x12*sin(psi + 1.5708) + 196200.0*x9*x11*sin(psi + 1.5708) - 10000.0*x7*x8*x11*cos(psi + 1.5708) - 10000.0*x7*x9*x12*cos(psi + 1.5708) - 10000.0*x7*x8*x10*sin(psi + 1.5708) - 10000.0*x8*x9*x12*sin(psi + 1.5708)))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361));
		double w2=-(1.0*(981.0*x11*cos(psi + 1.5708) - 981.0*x10*sin(psi + 1.5708) - 100.0*x8*x12*cos(psi + 1.5708) + 100.0*x9*x11*cos(psi + 1.5708) + 100.0*x7*x12*sin(psi + 1.5708) - 100.0*x9*x10*sin(psi + 1.5708)))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*sqrt(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361));
		double w3=(dpsi*fabs(100.0*x9 + 981.0))/(sqrt(1/(196200.0*x9 + 5000.0*x7*x7*cos(2.0*psi) - 5000.0*x8*x8*cos(2.0*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2.0*psi) + 962361.0))*sqrt(10000.0*x7*x7 + 10000.0*x8*x8 + 10000.0*x9*x9 + 196200.0*x9 + 962361.0)*sqrt(196200.0*x9 + 5000.0*x7*x7*cos(2.0*psi) - 5000.0*x8*x8*cos(2.0*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2.0*psi) + 962361.0)) - (fabs(x9 + 9.81)*(x8*cos(psi) - x7*sin(psi))*((0.01*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(1.49012e-8*x12 + 98100.0*x7*x10 + 98100.0*x8*x11 - 10000.0*x7*x7*x12 - 10000.0*x8*x8*x12 + 10000.0*x7*x9*x10 + 10000.0*x8*x9*x11))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) + (1.0*cos(psi + 1.5708)*(x9 + 9.81)*(9623.61*x11 - 981.0*x8*x12 + 1962.0*x9*x11 + 100.0*x7*x7*x11 + 100.0*x9*x9*x11 - 100.0*x7*x8*x10 - 100.0*x8*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) - (1.0*sin(psi + 1.5708)*(x9 + 9.81)*(9623.61*x10 - 981.0*x7*x12 + 1962.0*x9*x10 + 100.0*x8*x8*x10 + 100.0*x9*x9*x10 - 100.0*x7*x8*x11 - 100.0*x7*x9*x12))/(sqrt((100.0*x9 + 981.0)*(100.0*x9 + 981.0) + 10000.0*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708))*(x8*cos(psi + 1.5708) - 1.0*x7*sin(psi + 1.5708)))*pow(x7*x7 + x8*x8 + x9*x9 + 19.62*x9 + 96.2361,3/2)) - (1.0*dpsi*(100.0*x9 + 981.0)*(100.0*x9 + 981.0)*(x8*cos(psi) - x7*sin(psi)))/(sqrt(1/(196200.0*x9 + 5000.0*x7*x7*cos(2.0*psi) - 5000.0*x8*x8*cos(2.0*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2.0*psi) + 962361.0))*(x9 + 9.81)*sqrt(10000.0*x7*x7 + 10000.0*x8*x8 + 10000.0*x9*x9 + 196200.0*x9 + 962361.0)*(196200.0*x9 + 5000.0*x7*x7*cos(2*psi) - 5000.0*x8*x8*cos(2*psi) + 5000.0*x7*x7 + 5000.0*x8*x8 + 10000.0*x9*x9 + 10000.0*x7*x8*sin(2*psi) + 962361.0))))/(sqrt((x7*cos(psi) + x8*sin(psi))*(x7*cos(psi) + x8*sin(psi)) + (x9 + 9.81)*(x9 + 9.81)*(x9 + 9.81))*(x9 + 9.81));

		if(isnan(w2)){
			w2=0.0;

		}
		if(isnan(w1)){
			w1=0.0;

		}
		if(isnan(w3)){
			w3=0.0;
		}
		Reff->theta= theta;



		Reff->phi= phi;

		Reff->dphi= dphi;
		Reff->dtheta= dtheta;

		Reff->w1= w1;
		Reff->w2= w2;
		Reff->w3= w3;
		Reff->dphidpsi=dphidpsi;
		Reff->dthetadpsi=dthetadpsi;
	}
	else{
		Reff->x1=0.0;
		Reff->x2=0.0;
		Reff->x3= 0.0;
		Reff->x4= 0.0;
		Reff->x5= 0.0;
		Reff->x6= 0.0;
		Reff->x7= 0.0;
		Reff->x8=  0.0;;
		Reff->x9=  0.0;;
		Reff->x10= 0.0;;
		Reff->x11= 0.0;;
		Reff->x12= 0.0;;
		Reff->d4x=0.0;;
		Reff->d4y=0.0;;
		Reff->d4z=0.0;;
		Reff->x13= 0.0;;
		Reff->x14= 0.0;;
		Reff->d2psi=0.0;
		Reff->f=  9.81;


		Reff->df=  0.0;
		Reff->d2f=  0.0;

		Reff->w1=  0.0;
		Reff->w2=  0.0;
		Reff->w3=  0.0;
		Reff->psi=  0.0;
		Reff->dpsi=  0.0;
		Reff->theta=  0.0;
		Reff->dtheta=  0.0;
		Reff->phi=  0.0;
		Reff->dphi=  0.0;

	}

}




