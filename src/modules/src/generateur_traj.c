

#include <math.h>

#include "param.h"
#include "log.h"
#include "math3d.h"
#include "usec_time.h"
#include "generateur_traj.h"
/*
 static double COEEF[8][36]={{ 0.0000000472804563, -0.0000000865462947,   0, 0.0000000983719354,                  0,   0, 0.0000000590207108,  0.000000079007964,   0, -0.0000000345938832, 0.0000000923524008,   0, -0.0000000964030205, 0.0000000207884662,   0, -0.0000000695796653, -0.0000000698882884,   0, 0.0000000212149132, -0.0000000963100729,   0, 0.0000000925045984, -0.0000000341848205,   0, 0.0000000787459824, 0.0000000593697982,   0,                 0, 0.0000000983400982,   0, -0.0000000867546962, 0.0000000468969655,   0, -0.0000000863361981,  -0.000000047663021,   0},
		{  -0.00000109842214, -0.0000000381921225,   0, -0.000000561342453, -0.000000944925654,   0,  0.000000491832898, -0.000000982898896,   0,    0.00000109281935, -0.000000117199427,   0,   0.000000689072733,  0.000000856252655,   0,  -0.000000348204179,       0.00000104247,   0,  -0.00000106534377,   0.000000270245229,   0, -0.000000803011217,  -0.000000750441754,   0,   0.00000019760615,  -0.00000108117605,   0,  0.00000101654533, -0.000000417882071,   0,   0.000000900877426,  0.000000629610757,   0, -0.0000000430530331,    0.00000109824236,   0},
		{  0.000000107439659,     0.0000100475349,   0,  -0.00000839665916,   0.00000551911361,   0,  -0.00000918090827,  -0.00000408355524,   0,   -0.00000152427266,  -0.00000993182223,   0,     0.0000075337722,  -0.00000664881767,   0,    0.00000966530164,     0.0000027470792,   0,   0.00000291059733,    0.00000961732412,   0,  -0.00000652009675,     0.0000076454456,   0,  -0.00000995624394,  -0.00000135562035,   0, -0.00000423866637,   -0.0000091103352,   0,    0.00000537592152,  -0.00000848904988,   0,      0.000010047912, -0.0000000629712521,   0},
		{    0.0000999469169, -0.0000000252738898,   0,    0.0000540228169,     0.000084088775,   0,   -0.0000415696118,     0.000090891992,   0,    -0.0000989431311,    0.0000141295307,   0,     -0.000065348792,    -0.000075623556,   0,     0.0000283269251,     -0.000095848694,   0,    0.0000959589979,    -0.0000279509848,   0,    0.0000753668106,     0.0000656447309,   0,   -0.0000145172749,    0.0000988869838,   0,  -0.0000910542447,    0.0000412129998,   0,    -0.0000838763619,   -0.0000543520261,   0,   0.000000417061227,    -0.0000999460499,   0},
		{                  0,              -0.001,   0,     0.000841470985,    -0.000540302306,   0,     0.000909297427,     0.000416146837,   0,      0.000141120008,     0.000989992497,   0,     -0.000756802495,     0.000653643621,   0,     -0.000958924275,     -0.000283662185,   0,    -0.000279415498,     -0.000960170287,   0,     0.000656986599,     -0.000753902254,   0,     0.000989358247,     0.000145500034,   0,    0.000412118485,     0.000911130262,   0,     -0.000544021111,     0.000839071529,   0,     -0.000999990207,   -0.00000442569799,   0},
		{              -0.01,                   0,   0,     -0.00540302306,     -0.00841470985,   0,      0.00416146837,     -0.00909297427,   0,       0.00989992497,     -0.00141120008,   0,       0.00653643621,      0.00756802495,   0,      -0.00283662185,       0.00958924275,   0,     -0.00960170287,       0.00279415498,   0,     -0.00753902254,      -0.00656986599,   0,      0.00145500034,     -0.00989358247,   0,     0.00911130262,     -0.00412118485,   0,       0.00839071529,      0.00544021111,   0,    -0.0000442569799,       0.00999990207,   0},
		{                  0,                 0.1,   0,      -0.0841470985,       0.0540302306,   0,      -0.0909297427,      -0.0416146837,   0,       -0.0141120008,      -0.0989992497,   0,        0.0756802495,      -0.0653643621,   0,        0.0958924275,        0.0283662185,   0,       0.0279415498,        0.0960170287,   0,      -0.0656986599,        0.0753902254,   0,      -0.0989358247,      -0.0145500034,   0,     -0.0412118485,      -0.0911130262,   0,        0.0544021111,      -0.0839071529,   0,        0.0999990207,      0.000442569799,   0},
		{                1.0,                   0, 1.0,        0.540302306,        0.841470985, 1.0,       -0.416146837,        0.909297427, 1.0,        -0.989992497,        0.141120008, 1.0,        -0.653643621,       -0.756802495, 1.0,         0.283662185,        -0.958924275, 1.0,        0.960170287,        -0.279415498, 1.0,        0.753902254,         0.656986599, 1.0,       -0.145500034,        0.989358247, 1.0,      -0.911130262,        0.412118485, 1.0,        -0.839071529,       -0.544021111, 1.0,       0.00442569799,        -0.999990207, 1.0}};

static double time[13]={0, 10.0, 20.0, 30.0, 40.0, 50.0, 60.0, 70.0, 80.0, 90.0, 100.0, 110.0, 120.0};
 */
/*
static double COEEF[8][129]={{  -4.6090535,  58.7654321,  -46.090535,  0.879003626, -0.0623344053,   0, -0.861410362,  0.185755592,   0,  0.826575965,  -0.30545888,   0, -0.775197643,  0.419048406,   0,  0.708303736, -0.524250675,   0, -0.627233124,  0.618960064,   0,  0.533608437, -0.701280962,   0, -0.429303574,  0.769565718,   0,  0.316406197,  -0.82244761,   0, -0.197175947,  0.858868208,   0, 0.0739992201, -0.878098552,   0,  0.0506586022,   0.879753749,   0, -0.174302492, -0.863800668,   0,  0.294457717,  0.830558611,   0, -0.408719368, -0.780692917,   0,   0.514800498,   0.71520165,   0, -0.610577893, -0.635395616,   0,  0.694134567,  0.542872135,   0, -0.763798133, -0.439483065,   0,  0.818174274,  0.327297738,   0, -0.856174652, -0.208561544,   0,  0.877038688, 0.0856509903,   0,  -0.880348789,  0.038973869,   0,  0.866038703, -0.162818666,   0, -0.834394846,  0.283404646,   0,  0.786050571, -0.398318281,   0, -0.721973488,   0.505259572,   0,  0.643446101,  -0.60208809,   0, -0.552040136,   0.68686581,   0,  0.449585084, -0.757895906,   0, -0.338131583,  0.813756711,   0,  0.219910376,  -0.85333017,   0, -0.097287662,  0.875824219,   0,  -0.0272822655,  -0.880788641,   0,  0.151306138,  0.868124072,   0, -0.272301618, -0.838083994,   0,  0.387846978,  0.791269659,   0, -0.495629579, -0.728618057,   0,   0.59349215,  0.651383159,   0, -0.679475972, -0.561110823,   0,  -30.3672635,   50.5217645,   46.090535, 0, 0, 0},
{  11.3580247, -87.4074074,  69.1358025,  -1.37856099,  -0.753366872,   0,   1.47108017,  0.551285013,   0,  -1.53415568, -0.338169181,   0,   1.56652505,  0.118284891,   0,  -1.56754041,  0.103966873,   0,   1.53718143, -0.324137739,   0,  -1.47605577,  0.537820986,   0,   1.38538683, -0.740739742,   0,  -1.26698937,  0.928832587,   0,   1.12323311,  -1.09833484,   0, -0.956995325,   1.24585392,   0,   0.771603276,   -1.36843722,   0, -0.570767583,   1.46363124,   0,  0.358507972,  -1.52953067,   0, -0.139072822,   1.56481653,   0, -0.0831458716,  -1.56878258,   0,    0.3037004,   1.54134944,   0, -0.518176363,  -1.48306618,   0,  0.722281022,   1.39509934,   0, -0.911929222,  -1.27920957,   0,   1.08332515,   1.13771642,   0,  -1.23303832, -0.973451863,   0,    1.35807222,  0.789703662,   0,   -1.4559243, -0.590149537,   0,   1.52463604,  0.378783565,   0,  -1.56283218, -0.159836238,   0,   1.56974822, -0.0623102133,   0,  -1.54524574,  0.283209525,   0,   1.48981516, -0.498440396,   0,  -1.40456592,  0.703694979,   0,   1.29120428, -0.894865103,   0,  -1.15199917,   1.06812449,   0,  0.989736801,  -1.22000537,   0,    -0.80766484,    1.34746783,   0,   0.60942746,  -1.44796071,   0, -0.398992387,   1.51947264,   0,  0.180571478,  -1.56057232,   0,  0.041463571,   1.57043714,   0, -0.262668726,  -1.54886964,   0,  0.478616564,   1.49630151,   0,   49.5995597,  -73.8052497, -69.1358025, 0, 0, 0},
{ -10.3703704,  51.1111111, -41.4814815, 0.0908254787,    1.27025009,   0, -0.269174245,  -1.24472077,   0,  0.442135488,   1.19427835,   0, -0.606247385,  -1.11993244,   0,  0.758225237,   1.02317108,   0, -0.895027206, -0.905930935,   0,    1.0139152,  0.770558582,   0,  -1.11250967, -0.619763493,   0,   1.18883726,  0.456563834,   0,  -1.24137026, -0.284226047,   0,   1.26905722,  0.106199473,   0,     -1.271344,   0.073952684,   0,   1.24818481, -0.252624677,   0,   -1.2000432,  0.426240386,   0,   1.12788272, -0.591324891,   0,   -1.03314766,  0.744574024,   0,  0.917734137, -0.882920502,   0, -0.783952161,   1.00359532,   0,  0.634479377,  -1.10418317,   0, -0.472307484,   1.18267079,   0,  0.300682354,  -1.23748724,   0, -0.123039064,   1.26753538,   0, -0.0570668529,  -1.27221379,   0,  0.236030577,   1.25142883,   0, -0.410270147,  -1.20559652,   0,  0.576298158,   1.13563418,   0, -0.730791557,   -1.04294212,   0,  0.870658158,   0.92937556,   0,  -0.99309853, -0.797207545,   0,   1.09566203,  0.649083415,   0,  -1.17629584, -0.487967876,   0,   1.23338609,  0.317085657,   0,   -1.2657901, -0.139856967,   0,     1.27285932, -0.0401709621,   0,  -1.25445225,  0.219394869,   0,   1.21093731, -0.394227586,   0,  -1.14318545,  0.561169835,   0,   1.05255273, -0.716880266,   0, -0.940853153,  0.858242334,   0,  0.810322397, -0.982426675,   0,  -33.3783179,   41.7026557,  41.4814815, 0, 0, 0},
{   3.7037037,       -12.0,  10.3703704,  0.989764183, -0.0418677887,   0, -0.973950732,  0.181124326,   0,  0.938643651, -0.316755659,   0,  -0.88454961,  0.446047125,   0,  0.812751303, -0.566410955,   0, -0.724685773,  0.675438066,   0,  0.622115652, -0.770946279,   0, -0.507093882,  0.851023998,   0,  0.381922625, -0.914068465,   0, -0.249107184,  0.958817846,   0,  0.111305861, -0.984376481,   0,  0.0287232496,   0.990232814,   0, -0.168177464,  -0.97626963,   0,  0.304265606,  0.942766403,   0, -0.434263869, -0.890393701,   0,   0.555570338,  0.820199762,   0, -0.665757063,  -0.73358952,   0,  0.762618656,  0.632296478,   0, -0.844216431, -0.518348018,   0,  0.908917209,  0.394024819,   0, -0.955426002,  -0.26181521,   0,  0.982811938,  0.124365368,   0,  -0.990526886, 0.0155736472,   0,  0.978416432, -0.155200956,   0, -0.946722966,  0.291721917,   0,  0.896080833, -0.422404061,   0, -0.827503637,   0.544631785,   0,  0.742363949, -0.655958701,   0, -0.642365842,  0.754156598,   0,  0.529510779, -0.837260047,   0, -0.406057553,  0.903605729,   0,  0.274477083, -0.951865737,   0, -0.137402952,  0.981074146,   0, -0.00242129946,  -0.990646348,   0,  0.142197089,  0.980390758,   0, -0.279126803,  -0.95051264,   0,  0.410469792,  0.901610005,   0, -0.533597225, -0.834661639,   0,  0.646044706,  0.751007515,   0, -0.745561598, -0.652321971,   0,   9.63777169,  -8.41170042, -10.3703704, 0, 0, 0},
{           0,           0,           0,            0,          -1.0,   0,  0.141120008,  0.989992497,   0, -0.279415498, -0.960170287,   0,  0.412118485,  0.911130262,   0, -0.536572918, -0.843853959,   0,   0.65028784,  0.759687913,   0, -0.750987247, -0.660316708,   0,  0.836655639,   0.54772926,   0, -0.905578362, -0.424179007,   0,  0.956375928,  0.292138809,   0, -0.988031624,  -0.15425145,   0,    0.99991186,  0.0132767472,   0, -0.991778853,   0.12796369,   0,  0.963795386, -0.266642932,   0, -0.916521548,  0.399985315,   0,   0.850903525, -0.525321989,   0, -0.768254661,  0.640144339,   0,  0.670229176, -0.742154197,   0, -0.558789049,  0.829309833,   0,  0.436164755, -0.899866827,   0, -0.304810621,   0.95241298,   0,    0.1673557, -0.985896582,   0,  -0.026551154,  0.999647456,   0, -0.114784814,  -0.99339038,   0,  0.253823363,  0.967250588,   0, -0.387781635,  -0.92175127,   0,  0.513978456,   0.857803093,   0, -0.629887994, -0.776685982,   0,   0.73319032,  0.680023496,   0, -0.821817837, -0.569750334,   0,  0.893996664,  0.448073616,   0, -0.948282141, -0.317428702,   0,  0.983587745,  0.180430449,   0,   -0.999206834, -0.0398208804,   0,  0.994826791, -0.101585704,   0, -0.970535284,  0.240959049,   0,  0.926818505, -0.375509598,   0, -0.864551449,  0.502544319,   0,  0.784980389, -0.619520613,   0, -0.689697941,  0.724097197,   0,  0.580611184, -0.814180971,           0, 0, 0, 0},
{           0,           0,           0,         -1.0,             0,   0,  0.989992497, -0.141120008,   0, -0.960170287,  0.279415498,   0,  0.911130262, -0.412118485,   0, -0.843853959,  0.536572918,   0,  0.759687913,  -0.65028784,   0, -0.660316708,  0.750987247,   0,   0.54772926, -0.836655639,   0, -0.424179007,  0.905578362,   0,  0.292138809, -0.956375928,   0,  -0.15425145,  0.988031624,   0,  0.0132767472,   -0.99991186,   0,   0.12796369,  0.991778853,   0, -0.266642932, -0.963795386,   0,  0.399985315,  0.916521548,   0,  -0.525321989, -0.850903525,   0,  0.640144339,  0.768254661,   0, -0.742154197, -0.670229176,   0,  0.829309833,  0.558789049,   0, -0.899866827, -0.436164755,   0,   0.95241298,  0.304810621,   0, -0.985896582,   -0.1673557,   0,   0.999647456,  0.026551154,   0,  -0.99339038,  0.114784814,   0,  0.967250588, -0.253823363,   0,  -0.92175127,  0.387781635,   0,  0.857803093,  -0.513978456,   0, -0.776685982,  0.629887994,   0,  0.680023496,  -0.73319032,   0, -0.569750334,  0.821817837,   0,  0.448073616, -0.893996664,   0, -0.317428702,  0.948282141,   0,  0.180430449, -0.983587745,   0,  -0.0398208804,   0.999206834,   0, -0.101585704, -0.994826791,   0,  0.240959049,  0.970535284,   0, -0.375509598, -0.926818505,   0,  0.502544319,  0.864551449,   0, -0.619520613, -0.784980389,   0,  0.724097197,  0.689697941,   0, -0.814180971, -0.580611184,           0, 0, 0, 0},
{           0,           0,           0,            0,           1.0,   0, -0.141120008, -0.989992497,   0,  0.279415498,  0.960170287,   0, -0.412118485, -0.911130262,   0,  0.536572918,  0.843853959,   0,  -0.65028784, -0.759687913,   0,  0.750987247,  0.660316708,   0, -0.836655639,  -0.54772926,   0,  0.905578362,  0.424179007,   0, -0.956375928, -0.292138809,   0,  0.988031624,   0.15425145,   0,   -0.99991186, -0.0132767472,   0,  0.991778853,  -0.12796369,   0, -0.963795386,  0.266642932,   0,  0.916521548, -0.399985315,   0,  -0.850903525,  0.525321989,   0,  0.768254661, -0.640144339,   0, -0.670229176,  0.742154197,   0,  0.558789049, -0.829309833,   0, -0.436164755,  0.899866827,   0,  0.304810621,  -0.95241298,   0,   -0.1673557,  0.985896582,   0,   0.026551154, -0.999647456,   0,  0.114784814,   0.99339038,   0, -0.253823363, -0.967250588,   0,  0.387781635,   0.92175127,   0, -0.513978456,  -0.857803093,   0,  0.629887994,  0.776685982,   0,  -0.73319032, -0.680023496,   0,  0.821817837,  0.569750334,   0, -0.893996664, -0.448073616,   0,  0.948282141,  0.317428702,   0, -0.983587745, -0.180430449,   0,    0.999206834,  0.0398208804,   0, -0.994826791,  0.101585704,   0,  0.970535284, -0.240959049,   0, -0.926818505,  0.375509598,   0,  0.864551449, -0.502544319,   0, -0.784980389,  0.619520613,   0,  0.689697941, -0.724097197,   0, -0.580611184,  0.814180971,           0, 0, 0, 0},
{           0,           0,           0,          1.0,             0, 1.0, -0.989992497,  0.141120008, 1.0,  0.960170287, -0.279415498, 1.0, -0.911130262,  0.412118485, 1.0,  0.843853959, -0.536572918, 1.0, -0.759687913,   0.65028784, 1.0,  0.660316708, -0.750987247, 1.0,  -0.54772926,  0.836655639, 1.0,  0.424179007, -0.905578362, 1.0, -0.292138809,  0.956375928, 1.0,   0.15425145, -0.988031624, 1.0, -0.0132767472,    0.99991186, 1.0,  -0.12796369, -0.991778853, 1.0,  0.266642932,  0.963795386, 1.0, -0.399985315, -0.916521548, 1.0,   0.525321989,  0.850903525, 1.0, -0.640144339, -0.768254661, 1.0,  0.742154197,  0.670229176, 1.0, -0.829309833, -0.558789049, 1.0,  0.899866827,  0.436164755, 1.0,  -0.95241298, -0.304810621, 1.0,  0.985896582,    0.1673557, 1.0,  -0.999647456, -0.026551154, 1.0,   0.99339038, -0.114784814, 1.0, -0.967250588,  0.253823363, 1.0,   0.92175127, -0.387781635, 1.0, -0.857803093,   0.513978456, 1.0,  0.776685982, -0.629887994, 1.0, -0.680023496,   0.73319032, 1.0,  0.569750334, -0.821817837, 1.0, -0.448073616,  0.893996664, 1.0,  0.317428702, -0.948282141, 1.0, -0.180430449,  0.983587745, 1.0,   0.0398208804,  -0.999206834, 1.0,  0.101585704,  0.994826791, 1.0, -0.240959049, -0.970535284, 1.0,  0.375509598,  0.926818505, 1.0, -0.502544319, -0.864551449, 1.0,  0.619520613,  0.784980389, 1.0, -0.724097197, -0.689697941, 1.0,  0.814180971,  0.580611184,         1.0, 0, 0, 0}};

static double time[44]={ 0, 3.0, 6.0, 9.0, 12.0, 15.0, 18.0, 21.0, 24.0, 27.0, 30.0, 33.0, 36.0, 39.0, 42.0, 45.0, 48.0, 51.0, 54.0, 57.0, 60.0, 63.0, 66.0, 69.0, 72.0, 75.0, 78.0, 81.0, 84.0, 87.0, 90.0, 93.0, 96.0, 99.0, 102.0, 105.0, 108.0, 111.0, 114.0, 117.0, 120.0, 123.0, 126.0, 129.0};
 */
/*
static double COEEF[8][45]={{ -0.009072, 0.004956, -0.01008, 0.0000000472804563, -0.0000000865462947,   0, 0.0000000983719354,                  0,   0, 0.0000000590207108,  0.000000079007964,   0, -0.0000000345938832, 0.0000000923524008,   0, -0.0000000964030205, 0.0000000207884662,   0, -0.0000000695796653, -0.0000000698882884,   0, 0.0000000212149132, -0.0000000963100729,   0, 0.0000000925045984, -0.0000000341848205,   0, 0.0000000787459824, 0.0000000593697982,   0,                 0, 0.0000000983400982,   0, -0.0000000867546962, 0.0000000468969655,   0, -0.0000000863361981,  -0.000000047663021,   0,    0.0103146985, -0.000685649293, 0.01008, 0, 0, 0},
		{   0.04572, -0.02412,   0.0504,  -0.00000109842214, -0.0000000381921225,   0, -0.000000561342453, -0.000000944925654,   0,  0.000000491832898, -0.000000982898896,   0,    0.00000109281935, -0.000000117199427,   0,   0.000000689072733,  0.000000856252655,   0,  -0.000000348204179,       0.00000104247,   0,  -0.00000106534377,   0.000000270245229,   0, -0.000000803011217,  -0.000000750441754,   0,   0.00000019760615,  -0.00000108117605,   0,  0.00000101654533, -0.000000417882071,   0,   0.000000900877426,  0.000000629610757,   0, -0.0000000430530331,    0.00000109824236,   0,   -0.0516238432,    0.0026781366, -0.0504, 0, 0, 0},
		{   -0.0924,   0.0462,  -0.1008,  0.000000107439659,     0.0000100475349,   0,  -0.00000839665916,   0.00000551911361,   0,  -0.00000918090827,  -0.00000408355524,   0,   -0.00000152427266,  -0.00000993182223,   0,     0.0000075337722,  -0.00000664881767,   0,    0.00000966530164,     0.0000027470792,   0,   0.00000291059733,    0.00000961732412,   0,  -0.00000652009675,     0.0000076454456,   0,  -0.00000995624394,  -0.00000135562035,   0, -0.00000423866637,   -0.0000091103352,   0,    0.00000537592152,  -0.00000848904988,   0,      0.000010047912, -0.0000000629712521,   0,     0.103265282,   -0.0030921861,  0.1008, 0, 0, 0},
		{     0.078,  -0.0356,    0.084,    0.0000999469169, -0.0000000252738898,   0,    0.0000540228169,     0.000084088775,   0,   -0.0000415696118,     0.000090891992,   0,    -0.0000989431311,    0.0000141295307,   0,     -0.000065348792,    -0.000075623556,   0,     0.0000283269251,     -0.000095848694,   0,    0.0000959589979,    -0.0000279509848,   0,    0.0000753668106,     0.0000656447309,   0,   -0.0000145172749,    0.0000988869838,   0,  -0.0000910542447,    0.0000412129998,   0,    -0.0000838763619,   -0.0000543520261,   0,   0.000000417061227,    -0.0000999460499,   0,   -0.0856544684, -0.000521573589,  -0.084, 0, 0, 0},
		{         0,        0,        0,                  0,              -0.001,   0,     0.000841470985,    -0.000540302306,   0,     0.000909297427,     0.000416146837,   0,      0.000141120008,     0.000989992497,   0,     -0.000756802495,     0.000653643621,   0,     -0.000958924275,     -0.000283662185,   0,    -0.000279415498,     -0.000960170287,   0,     0.000656986599,     -0.000753902254,   0,     0.000989358247,     0.000145500034,   0,    0.000412118485,     0.000911130262,   0,     -0.000544021111,     0.000839071529,   0,     -0.000999990207,   -0.00000442569799,   0, -0.000536572918, -0.000843853959,       0, 0, 0, 0},
		{         0,        0,        0,              -0.01,                   0,   0,     -0.00540302306,     -0.00841470985,   0,      0.00416146837,     -0.00909297427,   0,       0.00989992497,     -0.00141120008,   0,       0.00653643621,      0.00756802495,   0,      -0.00283662185,       0.00958924275,   0,     -0.00960170287,       0.00279415498,   0,     -0.00753902254,      -0.00656986599,   0,      0.00145500034,     -0.00989358247,   0,     0.00911130262,     -0.00412118485,   0,       0.00839071529,      0.00544021111,   0,    -0.0000442569799,       0.00999990207,   0,  -0.00843853959,   0.00536572918,       0, 0, 0, 0},
		{         0,        0,        0,                  0,                 0.1,   0,      -0.0841470985,       0.0540302306,   0,      -0.0909297427,      -0.0416146837,   0,       -0.0141120008,      -0.0989992497,   0,        0.0756802495,      -0.0653643621,   0,        0.0958924275,        0.0283662185,   0,       0.0279415498,        0.0960170287,   0,      -0.0656986599,        0.0753902254,   0,      -0.0989358247,      -0.0145500034,   0,     -0.0412118485,      -0.0911130262,   0,        0.0544021111,      -0.0839071529,   0,        0.0999990207,      0.000442569799,   0,    0.0536572918,    0.0843853959,       0, 0, 0, 0},
		{         0,        0,        0,                1.0,                   0, 1.0,        0.540302306,        0.841470985, 1.0,       -0.416146837,        0.909297427, 1.0,        -0.989992497,        0.141120008, 1.0,        -0.653643621,       -0.756802495, 1.0,         0.283662185,        -0.958924275, 1.0,        0.960170287,        -0.279415498, 1.0,        0.753902254,         0.656986599, 1.0,       -0.145500034,        0.989358247, 1.0,      -0.911130262,        0.412118485, 1.0,        -0.839071529,       -0.544021111, 1.0,       0.00442569799,        -0.999990207, 1.0,     0.843853959,    -0.536572918,     1.0, 0, 0, 0}};

*/
/*
 * static double COEEF[8][45]={{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
*/

/*
 * static double COEEF[8][45]={{ 0.080556, 0.080556, 0,                0,                0, 0,                 0,                 0, 0,                 0,                 0, 0,                 0,                 0, 0,                 0,                 0, 0,                  0,                  0, 0,                  0,                  0, 0,                  0,                  0, 0,                   0,                   0, 0,                   0,                   0, 0,                  0,                  0, 0,                  0,                  0, 0,   0.0107205082,   0.0107205082, 0, 0, 0, 0},
{ -0.19566, -0.19566, 0,                0,                0, 0,                 0,                 0, 0,                 0,                 0, 0,                 0,                 0, 0,                 0,                 0, 0,                  0,                  0, 0,                  0,                  0, 0,                  0,                  0, 0,                   0,                   0, 0,                   0,                   0, 0,                  0,                  0, 0,                  0,                  0, 0,   -0.021027007,   -0.021027007, 0, 0, 0, 0},
{  0.18705,  0.18705, 0, 0.00000015625302, 0.00000015625302, 0, 0.000000151402637, 0.000000151402637, 0, 0.000000137138773, 0.000000137138773, 0, 0.000000114348283, 0.000000114348283, 0, 0.000000084448171, 0.000000084448171, 0, 0.0000000492974807, 0.0000000492974807, 0, 0.0000000110817119, 0.0000000110817119, 0, -0.000000027823064, -0.000000027823064, 0, -0.0000000649979364, -0.0000000649979364, 0, -0.0000000981315525, -0.0000000981315525, 0, -0.000000125163823, -0.000000125163823, 0, -0.000000144414014, -0.000000144414014, 0,   0.0123635274,   0.0123635274, 0, 0, 0, 0},
{ -0.07195, -0.07195, 0,                0,                0, 0, 0.000000773134808, 0.000000773134808, 0,  0.00000149820064,  0.00000149820064, 0,  0.00000213011562,  0.00000213011562, 0,  0.00000262959032,  0.00000262959032, 0,   0.00000296556983,   0.00000296556983, 0,   0.00000311716458,   0.00000311716458, 0,   0.00000307494913,   0.00000307494913, 0,    0.00000284154823,    0.00000284154823, 0,    0.00000243147363,    0.00000243147363, 0,   0.00000187022178,   0.00000187022178, 0,   0.00000119268859,   0.00000119268859, 0, 0.000855355806, 0.000855355806, 0, 0, 0, 0},
{        0,        0, 0,       -0.0000625,       -0.0000625, 0,  -0.0000605570264,  -0.0000605570264, 0,  -0.0000548489101,  -0.0000548489101, 0,  -0.0000457305543,  -0.0000457305543, 0,  -0.0000337688941,  -0.0000337688941, 0,   -0.0000197076476,   -0.0000197076476, 0,   -0.0000044210751,   -0.0000044210751, 0,    0.0000111403785,    0.0000111403785, 0,     0.0000260091773,     0.0000260091773, 0,     0.0000392608514,     0.0000392608514, 0,     0.000050071476,     0.000050071476, 0,    0.0000577688987,    0.0000577688987, 0, 0.000061874531, 0.000061874531, 0, 0, 0, 0},
{        0,        0, 0,                0,                0, 0,   -0.000309254949,   -0.000309254949, 0,   -0.000599281923,   -0.000599281923, 0,    -0.00085204845,    -0.00085204845, 0,    -0.00105183873,    -0.00105183873, 0,     -0.00118623077,     -0.00118623077, 0,     -0.00124686873,     -0.00124686873, 0,     -0.00122998243,     -0.00122998243, 0,      -0.00113662178,      -0.00113662178, 0,     -0.000972591496,     -0.000972591496, 0,     -0.00074809018,     -0.00074809018, 0,     -0.00047707624,     -0.00047707624, 0, -0.00017640001, -0.00017640001, 0, 0, 0, 0},
{        0,        0, 0,            0.025,            0.025, 0,      0.0242228105,      0.0242228105, 0,       0.021939564,       0.021939564, 0,      0.0182922217,      0.0182922217, 0,      0.0135075576,      0.0135075576, 0,      0.00788305906,      0.00788305906, 0,      0.00176843004,      0.00176843004, 0,     -0.00445615139,     -0.00445615139, 0,       -0.0104036709,       -0.0104036709, 0,       -0.0157043406,       -0.0157043406, 0,      -0.0200285904,      -0.0200285904, 0,      -0.0231075595,      -0.0231075595, 0,  -0.0247498124,  -0.0247498124, 0, 0, 0, 0},
{        0,        0, 0,                0,                0, 0,        0.12370198,        0.12370198, 0,       0.239712769,       0.239712769, 0,        0.34081938,        0.34081938, 0,       0.420735492,       0.420735492, 0,         0.47449231,         0.47449231, 0,        0.498747493,        0.498747493, 0,        0.491992973,        0.491992973, 0,         0.454648713,         0.454648713, 0,         0.389036598,         0.389036598, 0,        0.299236072,        0.299236072, 0,        0.190830496,        0.190830496, 0,    0.070560004,    0.070560004, 0, 0, 0, 0}};
 *
*/
/*
static double COEEF[8][45]={{ -0.48384,  1.4448, 0, 0.00679277314, -0.00225705795, 0, -0.00409120053,  0.00587351307, 0, -0.000237494778, -0.00715399705, 0,   0.00447173538, 0.00558924505, 0, -0.00692750972, -0.00180157893, 0,  0.00662812499, -0.00270259814, 0, -0.00369265032,  0.00613191742, 0, -0.000711438538, -0.00712249484, 0,   0.0048325792, 0.00528036512, 0, -0.00703174141, -0.00133816677, 0, 0.00643429027,  -0.0031362376, 0, -0.00327783973,  0.00636332022, 0,    1.50214111,  -0.255186726, 0, 0, 0, 0},
		{   1.3536, -3.5568, 0, -0.0213822759, -0.00760049396, 0,   0.0216789577, -0.00670760926, 0,   -0.0133536413,   0.0183480106, 0, -0.000282588826, -0.0226911739, 0,   0.0138064297,   0.0180097676, 0,  -0.0218392772, -0.00616564669, 0,   0.0211863653, -0.00813063059, 0,   -0.0121073654,   0.0191932523, 0, -0.00178688835, -0.0226224724, 0,   0.0149704738,   0.0170544465, 0, -0.0222001106, -0.00470364936, 0,     0.02060048, -0.00951784916, 0,   -3.78767992,   0.487175582, 0, 0, 0, 0},
		{  -1.5456,   3.444, 0,  0.0027095079,   0.0358628421, 0,   -0.023633617,   -0.027109722, 0,    0.0351583348,  0.00757471928, 0,    -0.032700134,   0.014972846, 0,   0.0172366723,  -0.0315655193, 0,  0.00508203405,   0.0356041825, 0,  -0.0253795505,  -0.0254826076, 0,    0.0355832957,  0.00522627439, 0,  -0.0316351098,  0.0171086149, 0,   0.0151052368,  -0.0326391896, 0, 0.00743218176,   0.0351887418, 0,  -0.0270137268,  -0.0237432821, 0,    3.80282764,  -0.241903515, 0, 0, 0, 0},
		{    0.744,   -1.34, 0,  0.0619018231, -0.00120427995, 0,  -0.0488715224,    0.038011318, 0,    0.0164043932,  -0.0597007695, 0,    0.0225869727,  0.0576464627, 0,  -0.0525952111,  -0.0326654216, 0,   0.0616856625, -0.00530707483, 0,  -0.0462429382,   0.0411688798, 0,     0.012408807,  -0.0606572956, 0,   0.0263604653,  0.0560215304, 0,  -0.0546458439,  -0.0291052872, 0,  0.0611978726,  -0.0093865003, 0,  -0.0434107259,   0.0441451568, 0,   -1.52402028,   -0.09218565, 0, 0, 0, 0},
		{        0,       0, 0,             0,         -0.125, 0,    0.074809018,    0.100142952, 0,    -0.119865534,  -0.0354577732, 0,     0.117249997, -0.0433294147, 0,  -0.0680026389,    0.104883941, 0, -0.00829023717,   -0.124724785, 0,     0.08128598,   0.0949609891, 0,    -0.121953251,  -0.0274299954, 0,    0.114118156, -0.0510102577, 0,  -0.0608968141,     0.10916308, 0, -0.0165439688,   -0.123900351, 0,    0.087405004,   0.0893608711, 0,  -0.123503953, -0.0192814312, 0, 0, 0, 0},
		{        0,       0, 0,         -0.25,              0, 0,    0.200285904,   -0.149618036, 0,   -0.0709155464,    0.239731069, 0,   -0.0866588295,  -0.234499994, 0,    0.209767882,    0.136005278, 0,    -0.24944957,   0.0165804743, 0,    0.189921978,    -0.16257196, 0,   -0.0548599908,    0.243906501, 0,   -0.102020515,  -0.228236313, 0,     0.21832616,    0.121793628, 0,  -0.247800703,   0.0330879375, 0,    0.178721742,   -0.174810008, 0, -0.0385628625,   0.247007906, 0, 0, 0, 0},
		{        0,       0, 0,             0,            0.5, 0,   -0.299236072,   -0.400571808, 0,     0.479462137,    0.141831093, 0,    -0.468999988,   0.173317659, 0,    0.272010555,   -0.419535765, 0,   0.0331609487,     0.49889914, 0,    -0.32514392,   -0.379843956, 0,     0.487813003,    0.109719982, 0,   -0.456472625,   0.204041031, 0,    0.243587256,    -0.43665232, 0,   0.066175875,    0.495601406, 0,   -0.349620016,   -0.357443484, 0,   0.494015812,  0.0771257249, 0, 0, 0, 0},
		{        0,       0, 0,           1.0,              0, 0,   -0.801143616,    0.598472144, 0,     0.283662185,   -0.958924275, 0,     0.346635318,   0.937999977, 0,   -0.839071529,   -0.544021111, 0,    0.997798279,  -0.0663218974, 0,   -0.759687913,     0.65028784, 0,     0.219439963,   -0.975626005, 0,    0.408082062,   0.912945251, 0,    -0.87330464,   -0.487174512, 0,   0.991202812,    -0.13235175, 0,   -0.714886969,    0.699240032, 0,    0.15425145,  -0.988031624, 0, 0, 0, 0}};

static double time[16]={ 0, 5.0, 10.0, 15.0, 20.0, 25.0, 30.0, 35.0, 40.0, 45.0, 50.0, 55.0, 60.0, 65.0, 70.0, 75.0};
*/
/*static double COEEF[8][21]={{ 0.00000007224, -0.000000024192, 0,                   0,                   0, 0,                 0,                  0, 0,                  0,                 0, 0,                   0,                 0, 0, -0.000000073775486, 0.0000000190012666, 0, 0, 0, 0},
{ -0.0000017784,    0.0000006768, 0,                   0, -0.0000000106911379, 0,                 0, 0.0000000108394789, 0,                  0,                 0, 0, -0.0000000113455869,                 0, 0,     0.000001828376, -0.000000550459798, 0, 0, 0, 0},
{    0.00001722,    -0.000007728, 0,   0.000000179314211,  0.0000000135475395, 0, -0.00000013554861, -0.000000118168085, 0, 0.0000000378735964, 0.000000175791674, 0,  0.0000000748642301, -0.00000016350067, 0,   -0.0000178524496,   0.00000665510539, 0, 0, 0, 0},
{    -0.000067,       0.0000372, 0, -0.0000000602139977,    0.00000309509116, 0,   0.0000019005659,  -0.00000244357612, 0,  -0.00000298503848, 0.000000820219658, 0,    0.00000288232313,  0.00000112934864, 0,    0.0000676863882,   -0.0000353042894, 0, 0, 0, 0},
{             0,               0, 0,          -0.0000625,                   0, 0,    0.000050071476,     0.000037404509, 0,   -0.0000177288866,  -0.0000599327672, 0,    -0.0000216647074,   0.0000586249985, 0,    0.0000524419706,   -0.0000340013194, 0, 0, 0, 0},
{            0,               0, 0,                   0,            -0.00125, 0,    -0.00074809018,      0.00100142952, 0,      0.00119865534,   -0.000354577732, 0,      -0.00117249997,   -0.000433294147, 0,     0.000680026389,      0.00104883941, 0, 0, 0, 0},
{            0,               0, 0,               0.025,                   0, 0,     -0.0200285904,      -0.0149618036, 0,      0.00709155464,      0.0239731069, 0,       0.00866588295,     -0.0234499994, 0,      -0.0209767882,       0.0136005278, 0, 0, 0, 0},
{            0,               0, 0,                   0,                 0.5, 0,       0.299236072,       -0.400571808, 0,       -0.479462137,       0.141831093, 0,         0.468999988,       0.173317659, 0,       -0.272010555,       -0.419535765, 0, 0, 0, 0}};

*/
 static double COEEF[8][45]={{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
		{ 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};
static double time[8]={ 0, 50.0, 100.0, 150.0, 200.0, 250.0, 300.0, 350.0};

static bool init=false;
static bool enlair=false;

void trajset(X_t *Reff,state_t *st0,X_t*X,double toffset){
	if(init==false){
		Reff->Morceau_traj=0;
		init=true;

		for(int i=0;i<8;i++){
			time[i]=time[i]+toffset+10.0;



		}
		/*
		COEEF[7][0]=COEEF[7][1]+(double)(st0->position.x);
		COEEF[7][1]=COEEF[7][1]+(double)(st0->position.y);
		COEEF[7][2]=COEEF[7][2]+(double)(st0->position.z);*/

	}

	double t1= usecTimestamp() / 1e6;
	int N=Reff->Morceau_traj;
	if( t1>=time[0] && N<=6){
		enlair=true;
		X->isInit=1;
		if(t1>=time[N+1]){

			N=N+1;
/*
			COEEF[7][N*3]=COEEF[7][N*3]+(double)(st0->position.x);
			COEEF[7][N*3+1]=COEEF[7][N*3+1]+(double)(st0->position.y);
			COEEF[7][N*3+2]=COEEF[7][N*3+2]+(double)(st0->position.z);
*/

			Reff->Morceau_traj=N;

		}
		double t0=time[N] ;





		double c70=COEEF[0][N*3];
		double c60=COEEF[1][N*3];
		double c50=COEEF[2][N*3];
		double c40=COEEF[3][N*3];
		double c30=COEEF[4][N*3];
		double c20=COEEF[5][N*3];
		double c10=COEEF[6][N*3];
		double c00=COEEF[7][N*3];

		double c71=COEEF[0][N*3+1];
		double  c61=COEEF[1][N*3+1];
		double c51=COEEF[2][N*3+1];
		double c41=COEEF[3][N*3+1];
		double  c31=COEEF[4][N*3+1];
		double c21=COEEF[5][N*3+1];
		double c11=COEEF[6][N*3+1];
		double c01=COEEF[7][N*3+1];


		double  c72=COEEF[0][N*3+2];
		double  c62=COEEF[1][N*3+2];
		double   c52=COEEF[2][N*3+2];
		double c42=COEEF[3][N*3+2];
		double  c32=COEEF[4][N*3+2];
		double  c22=COEEF[5][N*3+2];
		double  c12=COEEF[6][N*3+2];
		double  c02=COEEF[7][N*3+2];

		double P[3]={c00 - c10*(t0 - t1) + (c20*pow((t0-t1),2))/2 - (c30*pow((t0-t1),3))/6 + (c40*pow((t0-t1),4))/24 - (c50*pow((t0-t1),5))/120 + (c60*pow((t0-t1),6))/720 - (c70*pow((t0-t1),7))/5040, c01 - c11*(t0 - t1) + (c21*pow((t0-t1),2))/2 - (c31*pow((t0-t1),3))/6 + (c41*pow((t0-t1),4))/24 - (c51*pow((t0-t1),5))/120 + (c61*pow((t0-t1),6))/720 - (c71*pow((t0-t1),7))/5040, c02 - c12*(t0 - t1) + (c22*pow((t0-t1),2))/2 - (c32*pow((t0-t1),3))/6 + (c42*pow((t0-t1),4))/24 - (c52*pow((t0-t1),5))/120 + (c62*pow((t0-t1),6))/720 - (c72*pow((t0-t1),7))/5040};
		double dP[3]={c10 - c20*(t0 - t1) + (c30*pow((t0-t1),2))/2 - (c40*pow((t0-t1),3))/6 + (c50*pow((t0-t1),4))/24 - (c60*pow((t0-t1),5))/120 + (c70*pow((t0-t1),6))/720,c11 - c21*(t0 - t1) + (c31*pow((t0-t1),2))/2 - (c41*pow((t0-t1),3))/6 + (c51*pow((t0-t1),4))/24 - (c61*pow((t0-t1),5))/120 + (c71*pow((t0-t1),6))/720,c12 - c22*(t0 - t1) + (c32*pow((t0-t1),2))/2 - (c42*pow((t0-t1),3))/6 + (c52*pow((t0-t1),4))/24 - (c62*pow((t0-t1),5))/120 + (c72*pow((t0-t1),6))/720};
		double d2P[3]={c20 - c30*(t0 - t1) + (c40*pow((t0-t1),2))/2 - (c50*pow((t0-t1),3))/6 + (c60*pow((t0-t1),4))/24 - (c70*pow((t0-t1),5))/120,c21 - c31*(t0 - t1) + (c41*pow((t0-t1),2))/2 - (c51*pow((t0-t1),3))/6 + (c61*pow((t0-t1),4))/24 - (c71*pow((t0-t1),5))/120,c22 - c32*(t0 - t1) + (c42*pow((t0-t1),2))/2 - (c52*pow((t0-t1),3))/6 + (c62*pow((t0-t1),4))/24 - (c72*pow((t0-t1),5))/120};
		double d3P[3]={c30 - c40*(t0 - t1) + (c50*pow((t0-t1),2))/2 - (c60*pow((t0-t1),3))/6 + (c70*pow((t0-t1),4))/24, c31 - c41*(t0 - t1) + (c51*pow((t0-t1),2))/2 - (c61*pow((t0-t1),3))/6 + (c71*pow((t0-t1),4))/24,c32 - c42*(t0 - t1) + (c52*pow((t0-t1),2))/2 - (c62*pow((t0-t1),3))/6 + (c72*pow((t0-t1),4))/24};
		double d4P[3]={c40 - c50*(t0 - t1) + (c60*pow((t0-t1),2))/2 - (c70*pow((t0-t1),3))/6,c41 - c51*(t0 - t1) + (c61*pow((t0-t1),2))/2 - (c71*pow((t0-t1),3))/6,c42 - c52*(t0 - t1) + (c62*pow((t0-t1),2))/2 - (c72*pow((t0-t1),3))/6};
		Reff->x1= P[0]+(double)(st0->position.x);
		Reff->x2= P[1]+(double)(st0->position.y);
		Reff->x3= P[2]+(double)(st0->position.z);

		Reff->x4= dP[0];
		Reff->x5= dP[1];
		Reff->x6= dP[2];

		Reff->x7= d2P[0];
		Reff->x8= d2P[1];
		Reff->x9= d2P[2];

		Reff->x10= d3P[0];
		Reff->x11= d3P[1];
		Reff->x12= d3P[2];

		Reff->d4x= d4P[0];
		Reff->d4y= d4P[1];
		Reff->d4z= d4P[2];

		Reff->x13= 0.0;
		Reff->psi=0.0;
		Reff->dpsi= 0.0;

		Reff->x14= 0.0;
		Reff->d2psi= 0.0;
		double dpsi= Reff->x14;
		double psi= Reff-> x13;

		double x7=  Reff->x7;
		double x8=  Reff->x8;
		double x9=  Reff->x9;
		double x10=  Reff->x10;
		double x11=  Reff->x11;
		double x12=  Reff->x12;

		  double phi_tmp_tmp;
		  double b_phi_tmp_tmp;
		  double a_tmp_tmp_tmp;
		  double a_tmp_tmp;
		  double a_tmp;
		  double b_a_tmp;
		  double phi_tmp_tmp_tmp;
		  double c_phi_tmp_tmp;
		  double phi_tmp;
		  double b_phi_tmp;
		  double c_a_tmp;
		  double dphidpsi_tmp;
		  double b_dphidpsi_tmp;
		  double b_a_tmp_tmp;
		  double d_a_tmp;
		  double c_a_tmp_tmp;
		  double e_a_tmp;
		  double d_a_tmp_tmp;
		  double f_a_tmp;
		  double dphi_tmp;
		  double b_dphi_tmp;
		  double c_dphi_tmp;
		  double d_dphi_tmp;
		  double e_dphi_tmp;
		  double f_dphi_tmp;
		  double g_dphi_tmp;
		  double dtheta_tmp;
		  phi_tmp_tmp = cos(psi);
		  b_phi_tmp_tmp = sin(psi);
		  a_tmp_tmp_tmp = (x9 + 9.81) * (x9 + 9.81);
		  a_tmp_tmp = (a_tmp_tmp_tmp + x7 * x7) + x8 * x8;
		  a_tmp = sqrt(a_tmp_tmp);
		  b_a_tmp = x7 * phi_tmp_tmp / a_tmp + x8 * b_phi_tmp_tmp / a_tmp;
		  phi_tmp_tmp_tmp = b_a_tmp * b_a_tmp;
		  c_phi_tmp_tmp = phi_tmp_tmp_tmp * a_tmp_tmp / a_tmp_tmp_tmp + 1.0;
		  phi_tmp = sqrt(c_phi_tmp_tmp);
		  b_phi_tmp = phi_tmp * (x9 + 9.81);
		  double phi = -atan((x8 * phi_tmp_tmp / a_tmp - x7 * b_phi_tmp_tmp / a_tmp) * a_tmp /
		               b_phi_tmp);
		  c_a_tmp = x8 * cos(psi) / sqrt(((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8)
		    - x7 * sin(psi) / sqrt(((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8);
		  dphidpsi_tmp = c_a_tmp * c_a_tmp;
		  b_dphidpsi_tmp = c_phi_tmp_tmp * a_tmp_tmp_tmp;
		  double dphidpsi = (phi_tmp * b_a_tmp * c_a_tmp + b_phi_tmp * b_a_tmp / a_tmp) /
		    (dphidpsi_tmp + b_dphidpsi_tmp / a_tmp_tmp);
		  double theta = atan(b_a_tmp * a_tmp / (x9 + 9.81));
		  double dthetadpsi = (x9 + 9.81) * c_a_tmp / ((phi_tmp_tmp_tmp + a_tmp_tmp_tmp /
		    a_tmp_tmp) * a_tmp);
		  b_phi_tmp_tmp = cos(psi + 1.57);
		  phi_tmp_tmp_tmp = sin(psi + 1.57);
		  b_a_tmp_tmp = x8 * b_phi_tmp_tmp / a_tmp - x7 * phi_tmp_tmp_tmp / a_tmp;
		  d_a_tmp = fabs(b_a_tmp_tmp);
		  c_a_tmp_tmp = b_phi_tmp_tmp * (x9 + 9.81);
		  e_a_tmp = fabs(c_a_tmp_tmp);
		  d_a_tmp_tmp = phi_tmp_tmp_tmp * (x9 + 9.81);
		  f_a_tmp = fabs(d_a_tmp_tmp);
		  dphi_tmp = (x7 * x10 / a_tmp + x8 * x11 / a_tmp) + x12 * (x9 + 9.81) / a_tmp;
		  b_dphi_tmp = x12 - (x9 + 9.81) * dphi_tmp / a_tmp;
		  c_dphi_tmp = x11 - x8 * dphi_tmp / a_tmp;
		  dphi_tmp = x10 - x7 * dphi_tmp / a_tmp;
		  d_dphi_tmp = phi_tmp_tmp_tmp * a_tmp_tmp_tmp;
		  e_dphi_tmp = x8 * b_a_tmp_tmp;
		  f_dphi_tmp = b_phi_tmp_tmp * a_tmp_tmp_tmp;
		  phi_tmp_tmp = sqrt((d_a_tmp * d_a_tmp + e_a_tmp * e_a_tmp / a_tmp_tmp) +
		                     f_a_tmp * f_a_tmp / a_tmp_tmp);
		  g_dphi_tmp = phi_tmp_tmp * a_tmp_tmp;
		  phi_tmp_tmp *= a_tmp;
		  double dphi = (((x7 * b_phi_tmp_tmp * (x9 + 9.81) / g_dphi_tmp + x8 *
		             phi_tmp_tmp_tmp * (x9 + 9.81) / g_dphi_tmp) * b_dphi_tmp / a_tmp +
		            (x7 * b_a_tmp_tmp / phi_tmp_tmp - d_dphi_tmp / g_dphi_tmp) *
		            c_dphi_tmp / a_tmp) - dphi_tmp * (e_dphi_tmp / phi_tmp_tmp +
		            f_dphi_tmp / g_dphi_tmp) / a_tmp) + dpsi * b_a_tmp * a_tmp /
		    b_phi_tmp;
		  b_a_tmp_tmp *= b_dphi_tmp;
		  dtheta_tmp = dpsi * c_a_tmp * a_tmp;
		  phi_tmp_tmp_tmp = sqrt(dphidpsi_tmp * a_tmp_tmp / b_dphidpsi_tmp + 1.0);
		  double dtheta = phi_tmp_tmp_tmp * (((b_a_tmp_tmp / phi_tmp_tmp - c_a_tmp_tmp *
		    c_dphi_tmp / g_dphi_tmp) + d_a_tmp_tmp * dphi_tmp / g_dphi_tmp) + dtheta_tmp
		    / (c_phi_tmp_tmp * (x9 + 9.81) * phi_tmp_tmp_tmp));
		  double w1 = ((x7 * cos(psi + 1.57) * (x9 + 9.81) / (sqrt((e_a_tmp * e_a_tmp /
		             a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp * f_a_tmp / a_tmp_tmp) *
		           a_tmp_tmp) + x8 * sin(psi + 1.57) * (x9 + 9.81) / (sqrt((e_a_tmp *
		             e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp * f_a_tmp /
		            a_tmp_tmp) * a_tmp_tmp)) * b_dphi_tmp / a_tmp + (x7 * (x8 * cos(psi
		            + 1.57) / sqrt(((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8) - x7
		           * sin(psi + 1.57) / sqrt(((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 *
		            x8)) / (sqrt((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) +
		            f_a_tmp * f_a_tmp / a_tmp_tmp) * a_tmp) - d_dphi_tmp / (sqrt
		           ((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp *
		            f_a_tmp / a_tmp_tmp) * a_tmp_tmp)) * c_dphi_tmp / a_tmp) - dphi_tmp *
		    (e_dphi_tmp / (sqrt((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) +
		                        f_a_tmp * f_a_tmp / a_tmp_tmp) * a_tmp) + f_dphi_tmp /
		     (sqrt((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp *
		           f_a_tmp / a_tmp_tmp) * a_tmp_tmp)) / a_tmp;
		  phi_tmp_tmp = cos(psi + 1.57) * (x9 + 9.81) * (x11 - x8 * ((x7 * x10 / sqrt
		    (((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8) + x8 * x11 / sqrt(((x9 +
		    9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8)) + x12 * (x9 + 9.81) / sqrt(((x9 +
		    9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8)) / sqrt(((x9 + 9.81) * (x9 + 9.81)
		    + x7 * x7) + x8 * x8));
		  b_phi_tmp_tmp = sin(psi + 1.57) * (x9 + 9.81) * (x10 - x7 * ((x7 * x10 / sqrt
		    (((x9 + 9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8) + x8 * x11 / sqrt(((x9 +
		    9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8)) + x12 * (x9 + 9.81) / sqrt(((x9 +
		    9.81) * (x9 + 9.81) + x7 * x7) + x8 * x8)) / sqrt(((x9 + 9.81) * (x9 + 9.81)
		    + x7 * x7) + x8 * x8));
		  double w2 = (b_a_tmp_tmp / (sqrt((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp)
		           + f_a_tmp * f_a_tmp / a_tmp_tmp) * a_tmp) - phi_tmp_tmp / (sqrt
		          ((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp *
		           f_a_tmp / a_tmp_tmp) * a_tmp_tmp)) + b_phi_tmp_tmp / (sqrt((e_a_tmp *
		    e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp * f_a_tmp / a_tmp_tmp) *
		    a_tmp_tmp);
		  double w3 = dpsi / (phi_tmp * phi_tmp_tmp_tmp) + (x8 * cos(psi) / sqrt(((x9 + 9.81) *
		    (x9 + 9.81) + x7 * x7) + x8 * x8) - x7 * sin(psi) / sqrt(((x9 + 9.81) * (x9
		    + 9.81) + x7 * x7) + x8 * x8)) * sqrt(((x9 + 9.81) * (x9 + 9.81) + x7 * x7)
		    + x8 * x8) * (((b_a_tmp_tmp / (sqrt((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp
		    * d_a_tmp) + f_a_tmp * f_a_tmp / a_tmp_tmp) * a_tmp) - phi_tmp_tmp / (sqrt
		    ((e_a_tmp * e_a_tmp / a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp * f_a_tmp /
		     a_tmp_tmp) * a_tmp_tmp)) + b_phi_tmp_tmp / (sqrt((e_a_tmp * e_a_tmp /
		    a_tmp_tmp + d_a_tmp * d_a_tmp) + f_a_tmp * f_a_tmp / a_tmp_tmp) * a_tmp_tmp))
		                  + dtheta_tmp / ((b_a_tmp * b_a_tmp * a_tmp_tmp / a_tmp_tmp_tmp
		    + 1.0) * (x9 + 9.81) * sqrt(c_a_tmp * c_a_tmp * a_tmp_tmp / ((b_a_tmp *
		    b_a_tmp * a_tmp_tmp / a_tmp_tmp_tmp + 1.0) * a_tmp_tmp_tmp) + 1.0))) /
		    b_phi_tmp;
		Reff->theta= theta;



		Reff->phi= phi;

		Reff->dphi= dphi;
		Reff->dtheta= dtheta;

		Reff->w1= w1;
		Reff->w2= w2;
		Reff->w3= w3;
		Reff->dphidpsi=dphidpsi;
		Reff->dthetadpsi=dthetadpsi;
	}
	else{
		if(enlair){
		//X->isInit=0;
		}
		Reff->x1= (st0->position.x);
		Reff->x2= (st0->position.y);
		Reff->x3= (st0->position.z);
		Reff->x4= 0.0;
		Reff->x5= 0.0;
		Reff->x6= 0.0;
		Reff->x7= 0.0;
		Reff->x8=  0.0;
		Reff->x9=  0.0;
		Reff->x10= 0.0;
		Reff->x11= 0.0;
		Reff->x12= 0.0;
		Reff->d4x=0.0;
		Reff->d4y=0.0;
		Reff->d4z=0.0;
		Reff->x13= 0.0;
		Reff->x14= 0.0;
		Reff->d2psi=0.0;
		Reff->f=  9.81;


		Reff->df=  0.0;
		Reff->d2f=  0.0;

		Reff->w1=  0.0;
		Reff->w2=  0.0;
		Reff->w3=  0.0;
		Reff->psi=  0.0;
		Reff->dpsi=  0.0;
		Reff->theta=  0.0;
		Reff->dtheta=  0.0;
		Reff->phi=  0.0;
		Reff->dphi=  0.0;

	}

}




